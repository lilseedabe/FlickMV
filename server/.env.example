# ===========================
# FlickMV Server .env (Supabase + pg-boss, no Mongo/Redis)
# Version: 1.1.0
# ===========================

# Server
NODE_ENV=development
PORT=5000
CLIENT_URL=http://localhost:3000
WS_PUBLIC_URL=ws://localhost:5000

# Internal API (for on-demand worker and admin tools)
# Keep this secret on the server/worker only, never expose to frontend.
INTERNAL_API_KEY=change-me-strong-random

# ===========================
# Supabase (Postgres) â€” App primary DB + pg-boss queue
# NOTE: Keep service_role key ONLY on the server/worker.
# ===========================
# Supabase Postgres connection string
SUPABASE_POSTGRES_URL=postgres://USER:PASSWORD@HOST:5432/DB_NAME
# For libraries expecting DATABASE_URL, mirror the same value:
DATABASE_URL=postgres://USER:PASSWORD@HOST:5432/DB_NAME

# Supabase service role (server-side only)
SUPABASE_SERVICE_ROLE_KEY=your-supabase-service-role-key
SUPABASE_URL=https://your-project-id.supabase.co

# pg-boss settings
PGBOSS_SCHEMA=pgboss
EXPORT_QUEUE_NAME=video-export

# ===========================
# Auth (JWT)
# ===========================
JWT_SECRET=change-me-in-production
JWT_EXPIRES_IN=7d

# ===========================
# Storage (Cloudflare R2 - S3 compatible)
# ===========================
# NEVER expose these to the frontend
R2_ACCOUNT_ID=your-r2-account-id
R2_ACCESS_KEY_ID=your-r2-access-key
R2_SECRET_ACCESS_KEY=your-r2-secret-key
R2_BUCKET=flickmv-exports
# e.g. https://<ACCOUNT_ID>.r2.cloudflarestorage.com
R2_ENDPOINT=https://your-account-id.r2.cloudflarestorage.com
# Optional: public CDN base for serving exported files
R2_PUBLIC_BASE_URL=https://cdn.yourdomain.com/exports

# ===========================
# Media Processing (FFmpeg)
# ===========================
FFMPEG_PATH=/usr/bin/ffmpeg
FFPROBE_PATH=/usr/bin/ffprobe

# ===========================
# AI Services
# ===========================
# Groq API for audio transcription (Whisper-large-v3)
GROQ_API_KEY=your-groq-api-key

# MoonshotAI API for MV prompt generation (Kimi-K2-Instruct)
MOONSHOT_API_KEY=your-moonshot-api-key

# ===========================
# Security / Rate Limiting
# ===========================
RATE_LIMIT_WINDOW=15
RATE_LIMIT_MAX=100

# ===========================
# Logging
# ===========================
LOG_LEVEL=info
LOG_FILE=./logs/app.log

# ===========================
# Frontend (put these in client/.env.*)
# ===========================
# REACT_APP_API_URL=http://localhost:5000/api
# REACT_APP_WS_URL=ws://localhost:5000

# ===========================
# On-demand Worker (Cloud Run Jobs / GCE) runtime env (example)
# ===========================
# DATABASE_URL=postgres://USER:PASSWORD@HOST:5432/DB_NAME
# EXPORT_QUEUE_NAME=video-export
# INTERNAL_API_BASE=https://your-api-domain.com/api/internal
# INTERNAL_API_KEY=change-me-strong-random
# R2_ACCOUNT_ID=...
# R2_ACCESS_KEY_ID=...
# R2_SECRET_ACCESS_KEY=...
# R2_BUCKET=flickmv-exports
# R2_ENDPOINT=https://<ACCOUNT_ID>.r2.cloudflarestorage.com
# R2_PUBLIC_BASE_URL=https://cdn.yourdomain.com/exports
# LOG_LEVEL=info